<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Shower Presentation Engine</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="shower/themes/ribbon/styles/styles.css" />
    <link
      rel="stylesheet"
      href="node_modules/@shower/ribbon/styles/styles.css"
    />
    <style>
      .shower {
        --slide-ratio: calc(16 / 9);
      }

      .slide {
        padding-top: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      img {
        width: 100%;
      }
    </style>
  </head>
  <body class="shower list">
    <header class="caption">
      <h1>File System Access API (fsa-api)</h1>
      <a
        href="https://parabolabam.github.io/fsa-presentation/index.pdf"
        target="_blank"
        rel="noopener noreferrer"
        >PDF version</a
      >
    </header>

    <section class="slide">File System Access API</section>

    <section class="slide">
      <div>About me</div>

      <iframe
        style="border-radius: 15px; width: 100%; height: 90%"
        src="https://parabolabam.github.io/CV/"
        frameborder="0"
      ></iframe>
    </section>

    <section class="slide">
      Plan
      <div>Careful, spoilers</div>
      <img
        style="height: 200px; width: 200px"
        src="pics/tom-spoiland.jpeg"
        alt="Tom Holland"
      />
    </section>

    <section class="slide">
      Plan
      <ol>
        <li>Project FUGU;</li>
        <li>Web platform and tests</li>
        <li>
          File System Access API
          <ol>
            <li>What is that</li>
            <li>Why is that</li>
            <li>Pros and Cons</li>
            <li>Security</li>
            <li>Demos</li>
            <li>Questions</li>
          </ol>
        </li>
      </ol>
    </section>

    <section class="slide">
      <a
        href="https://web.dev/fugu-status/"
        target="_blank"
        rel="noopener noreferrer"
        >Project FUGU</a
      >
      <img
        width="100%"
        height="50%"
        src="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/uIIvM9xocYkjmBfHSrJE.svg"
        alt="project FUGU logo"
      />
    </section>

    <section class="slide">
      The capabilities project is a cross-company effort with the objective of
      making it possible for web apps to do anything iOS/Android/desktop apps
      can, by exposing the capabilities of these platforms to the web platform,
      while maintaining user security, privacy, trust, and other core tenets of
      the web.
    </section>

    <section class="slide">
      You can see the full list of new and potential capabilities and the stage
      each proposal is in on the
      <a
        href="https://fugu-tracker.web.app/"
        target="_blank"
        rel="noopener noreferrer"
        >FUGUüê° API tracker</a
      >
    </section>

    <section class="slide">
      <a
        href="https://web.dev/fugu-status/#suggest-new"
        target="_blank"
        rel="noopener noreferrer"
        >You can even suggest your own feature of capability üòé</a
      >
    </section>

    <section class="slide">
      If you are interested you can join conversations there
      <div>
        Mailing list
        <a
          href="https://groups.google.com/a/chromium.org/forum/#!forum/fugu-dev"
          target="_blank"
          rel="noopener noreferrer"
          >fugu-dev@chromium.org</a
        >
      </div>
      <div>
        Slack Channel: #fugu on
        <a
          href="https://chromiumdev.slack.com/"
          target="_blank"
          rel="noopener noreferrer"
          >@chromium</a
        >
      </div>
    </section>

    <section class="slide center">
      Alright, we're done with ads, let's finally get back to the point!
      <img
        src="pics/get-to-the-point.jpeg"
        alt="Sheldon explains near whiteboard"
      />
    </section>

    <section class="slide">
      Let's take a look at what FUGU page says about File System Access API
      <img src="pics/FSA-FUGU-STATE.png" alt="file-system-access gugu state" />
      <div>
        <a
          href="https://bugs.chromium.org/p/chromium/issues/detail?id=853326"
          target="_blank"
          rel="noopener noreferrer"
          >Bug tracker for Blink browsers of FileSystem Access</a
        >
      </div>
      <div>
        <a
          href="https://chromestatus.com/feature/6284708426022912"
          target="_blank"
          rel="noopener noreferrer"
          >Chromium status</a
        >
      </div>
    </section>

    <section class="slide">
      Let's take a look at what FUGU page says about File System Access API
      <img src="pics/FSA-FUGU-STATE.png" alt="file-system-access gugu state" />
      <div>
        <a
          href="https://bugs.chromium.org/p/chromium/issues/detail?id=853326"
          target="_blank"
          rel="noopener noreferrer"
          >Bug tracker for Blink browsers of FileSystem Access</a
        >
      </div>
      <div>
        <a
          href="https://chromestatus.com/feature/6284708426022912"
          target="_blank"
          rel="noopener noreferrer"
          >Chromium status</a
        >
      </div>

      <div
        style="
          font-size: 14px;
          display: flex;
          flex-flow: column wrap;
          place-items: center;
        "
      >
        By the way, it was first shipped in Chrome 91
        <div>ü§ìü§ìü§ì</div>
      </div>
    </section>

    <section class="slide">
      Let's take a look at web platform experimental features tests failures
      <img
        src="pics/web-platform-tests-failures.png"
        alt="web platform tests failures"
      />
    </section>

    <section class="slide">
      What do we see?
      <div style="display: flex; flex-flow: row wrap">
        <img
          src="pics/web-platform-tests-failures.png"
          alt="web platform tests failures"
        />
        <img
          style="width: 300px"
          src="pics/math.jpeg"
          alt="Bearded man doing math"
        />
      </div>
    </section>

    <section class="slide">
      Right! Nothing, my curious minds!
      <div>ü•≥ü•≥ü•≥</div>
    </section>

    <section class="slide">
      Right! Nothing, my curious minds!
      <div>ü•≥ü•≥ü•≥</div>
      Because there are no tests on web platform for File System API just yet
    </section>

    <section class="slide">
      But what is File System Access API? What does it mean for those all who
      uses web apps?
    </section>

    <section class="slide">
      But what is File System Access API? What does it mean for those all who
      uses web apps?

      <div>Well, let's figure it out</div>
    </section>

    <section class="slide">
      File System Access API is obviously is the application programming
      interface.
      <img
        style="width: 100px; height: 100px"
        src="pics/wow.png"
        alt="straight face made of sticks"
      />
    </section>

    <section class="slide">
      More formally, how the first implementer states:
      <q>
        <i>
          <strong>
            This API enables developers to build powerful apps that interact
            with other (non-Web) apps on the user‚Äôs device via the device‚Äôs file
            system.
          </strong>
        </i>
        (c) Chrome (taken from
        <a
          href="https://chromestatus.com/feature/6284708426022912"
          target="_blank"
          rel="noopener noreferrer"
          >here</a
        >
        )
      </q>
    </section>

    <section class="slide center">
      <img src="pics/spec.png" alt="spec" />
      <a
        href="https://wicg.github.io/file-system-access/"
        target="_blank"
        rel="noopener noreferrer"
      >
        https://wicg.github.io/file-system-access/
      </a>
    </section>

    <section class="slide center">
      <img src="pics/spec.png" alt="spec" />
      <a
        href="https://wicg.github.io/file-system-access/"
        target="_blank"
        rel="noopener noreferrer"
      >
        https://wicg.github.io/file-system-access/
      </a>

      <div>
        This particular spec is developed by W3C (The World Wide Web Consortium)
      </div>
      <a href="https://www.w3.org/" target="_blank" rel="noopener noreferrer">
        <img
          style="width: 90px; height: 53px"
          width="90"
          height="53"
          src="https://www.w3.org/2008/site/images/logo-w3c-mobile-lg"
          alt="w3c logo"
      /></a>
    </section>

    <section class="slide">What is the reason for that feature?</section>

    <section class="slide">
      In native applications, there are common file access patterns.
    </section>

    <section class="slide">
      In native applications, there are common file access patterns. For
      instance (all examples are high-level):
      <ol>
        <li>
          For Android (via Kotlin of Java):
          <ol>
            <li>
              <a
                href="https://developer.android.com/training/data-storage/app-specific#internal-access-store-files"
                target="_blank"
                rel="noopener noreferrer"
              >
                File API
              </a>
            </li>
            <li>
              <a
                href="https://developer.android.com/training/data-storage/app-specific#internal-store-stream"
                target="_blank"
                rel="noopener noreferrer"
              >
                Open files using stream
              </a>
            </li>
            <li>etc</li>
          </ol>
        </li>
        <li>
          For IOS:
          <ol>
            <li>
              <a
                href="https://www.appypie.com/filemanager-files-swift-how-to/#iOS"
                target="_blank"
                rel="noopener noreferrer"
              >
                File Manager
              </a>
            </li>
          </ol>
        </li>
        <li>
          For desktop:
          <ol>
            <li>Windows APIs</li>
            <li>Linux Filesystems API</li>
          </ol>
        </li>
      </ol>
    </section>

    <section class="slide">But are there any for browsers?</section>

    <section class="slide">
      But are there any for browsers? Spoiler: topic of report says about it ü•∏
    </section>

    <section class="slide">
      Let's consider cases when you may need to interact with FS (File System)
    </section>

    <section class="slide">
      According to opinion of chrome team, the reason to interact with file
      system is to interact with native applications.
    </section>

    <section class="slide">
      Here it is
      <div>
        <q>
          <i>
            The main overarching goal here is to increase interoperability of
            web applications with native applications, specifically where it
            comes to being able to operate on the native file system.
          </i>
        </q>
      </div>
    </section>

    <section class="slide">
      <div>Cases when you may need it</div>
      <div>
        <ul>
          <li>
            <a
              href="https://github.com/WICG/file-system-access/blob/main/EXPLAINER.md#use-cases"
              target="_blank"
              rel="noopener noreferrer"
              >single file editor;</a
            >
          </li>
        </ul>
      </div>
    </section>

    <section class="slide">
      <div>Cases when you may need it</div>
      <div>
        <ul>
          <li>
            <a
              href="https://github.com/WICG/file-system-access/blob/main/EXPLAINER.md#use-cases"
              target="_blank"
              rel="noopener noreferrer"
              >single file editor;</a
            >
          </li>
          <li>
            <a
              href="https://github.com/WICG/file-system-access/blob/main/EXPLAINER.md#multi-file-editor"
              target="_blank"
              rel="noopener noreferrer"
              >multi-file Editor</a
            >
          </li>
        </ul>
      </div>
    </section>

    <section class="slide">
      <div>Cases when you may need it</div>
      <div>
        <ul>
          <li>
            <a
              href="https://github.com/WICG/file-system-access/blob/main/EXPLAINER.md#use-cases"
              target="_blank"
              rel="noopener noreferrer"
              >single file editor;</a
            >
          </li>
          <li>
            <a
              href="https://github.com/WICG/file-system-access/blob/main/EXPLAINER.md#multi-file-editor"
              target="_blank"
              rel="noopener noreferrer"
              >multi-file Editor;</a
            >
          </li>
          <li>
            <a
              href="https://github.com/WICG/file-system-access/blob/main/EXPLAINER.md#file-libraries"
              target="_blank"
              rel="noopener noreferrer"
              >file libraries;</a
            >
          </li>
        </ul>
      </div>
    </section>

    <section class="slide">How to use?</section>

    <section
      class="slide center"
      style="font-size: 14px; display: flex; flex-wrap: wrap"
    >
      <div>Example of custom setup (<mark>we can do it!</mark>)</div>
      <div><a href="" target="_blank" rel="noopener noreferrer"></a></div>

      <iframe
        width="100%"
        height="500"
        src="picker-options-demo.html"
        frameborder="0"
      ></iframe>
    </section>

    <section class="slide">
      <div>Legacy for file picking</div>
      <input type="file" name="input" accept=".jpg" />
    </section>

    <section class="slide">
      Are there any <mark>real-life</mark> examples of usage of that brand new
      API?
    </section>

    <section class="slide">
      <div>Of course there are ü•≥ü•≥ü•≥</div>
      <div>Check them!</div>
    </section>

    <section class="slide">
      <iframe
        width="100%"
        height="500"
        src="https://googlechromelabs.github.io/text-editor/"
        frameborder="0"
      ></iframe>
      <div>
        It works poorly in iframe that I use for demos, but here is the
        <a
          href="https://googlechromelabs.github.io/text-editor/"
          target="_blank"
          rel="noopener noreferrer"
          ><strong>link</strong></a
        >
      </div>
    </section>

    <section class="slide">
      <iframe
        width="100%"
        height="500px"
        src="https://vscode.dev/"
        frameborder="0"
      ></iframe>
      <div>
        It works poorly in iframe that I use for demos, but here is the
        <a href="https://vscode.dev/" target="_blank" rel="noopener noreferrer"
          ><strong>link</strong></a
        >
      </div>
    </section>

    <section class="slide center">
      Unfortunately, I am not invited to beta-testing of Photo shop for web,
      <a
        href="https://photoshop.adobe.com"
        target="_blank"
        rel="noopener noreferrer"
      >
        but this states that there is the Adobe PS for Web
      </a>
    </section>

    <section class="slide center">
      <div>OK</div>
      <img style="width: 300px" width="300px" src="pics/ok.png" alt="" />
    </section>

    <section class="slide center">
      <div>OK</div>
      <img style="width: 300px" width="300px" src="pics/ok.png" alt="" />

      <div>But what is under the hood?</div>
    </section>

    <section class="slide">
      A bit of terminology
      <img
        style="width: 500px"
        width="500px"
        src="https://imgflip.com/s/meme/X-X-Everywhere.jpg"
        alt="woody and buzz look into future"
      />
    </section>

    <section class="slide">
      An <mark><strong>entry</strong></mark> is either a file entry or a
      directory entry.
    </section>

    <section class="slide">
      An <mark><strong>entry</strong></mark> is either a file entry or a
      directory entry.

      <div>
        i.e. something that represents file of directory in terms of FSA API
      </div>
    </section>

    <section class="slide">
      The FSA API builds on top of
      <a
        href="https://www.w3.org/TR/FileAPI/"
        target="_blank"
        rel="noopener noreferrer"
        >File API</a
      >
    </section>

    <section class="slide">So let's take a look at terms for File API</section>

    <section class="slide">
      A Blob object refers to a byte sequence, and has a size attribute which is
      the total number of bytes in the byte sequence, and a type attribute,
      which is an ASCII-encoded string in lower case representing the media type
      of the byte sequence.
      <a
        href="https://w3c.github.io/FileAPI/#dfn-Blob"
        target="_blank"
        rel="noopener noreferrer"
        >Term defined by File API spec made by W3C
      </a>
    </section>

    <section class="slide">
      A Blob blob has an associated get stream algorithm, but we'll stick to
      that fact only otherwise it is for a long time
    </section>

    <section class="slide">
      We better take a look at how FSA API and Blobs are related
    </section>

    <section class="slide">
      Interface of File Entry has method called <mark>createWritable</mark>
    </section>

    <section class="slide">
      Interface of File Entry has method called <mark>createWritable</mark>

      <div>
        it returns <mark>FileSystemWritableFileStream</mark> object that is in
        fact
        <mark
          ><a
            href="https://streams.spec.whatwg.org/#writablestream"
            target="_blank"
            rel="noopener noreferrer"
            >WritableStream (according to WHATWG Streams Spec)</a
          ></mark
        >
        object
      </div>
    </section>

    <section class="slide">
      Interface of File Entry has method called <mark>createWritable</mark>

      <div>
        it returns <mark>FileSystemWritableFileStream</mark> object that is in
        fact
        <mark
          ><a
            href="https://streams.spec.whatwg.org/#writablestream"
            target="_blank"
            rel="noopener noreferrer"
            >WritableStream (according to WHATWG Streams Spec)</a
          ></mark
        >
        object
      </div>
      <div>
        and has method called <mark>write()</mark> that accepts object of
        properties where Blob data can be found
      </div>
    </section>

    <section class="slide center">
      <div>OK</div>
      <img style="width: 300px" width="300px" src="pics/ok.png" alt="" />
    </section>

    <section class="slide center">
      <div>OK</div>
      <img style="width: 300px" width="300px" src="pics/ok.png" alt="" />

      But what about its issues? Looks a bit flawless, doesn't it?
    </section>

    <section class="slide">
      There are so many of them that I would be able to create a new little
      report about them.

      <div>
        üö© Note: I'd like to talk about problems that were issued by spec
        authors! üö©
      </div>
    </section>

    <section class="slide">Security Risks</section>

    <section class="slide">
      Security Risks
      <div>
        <ol>
          <li>
            Electron does not update regularly and also is about to not to
            effectively defend XSS
          </li>
          <li>
            Small utilities, such as archivers and image/PDF resizing/cropping,
            are often native applications that run with the user‚Äôs full
            privileges. Some of these applications deliver malware.
          </li>
          <li></li>
        </ol>
      </div>
    </section>

    <section class="slide">Worth mentioning the following attack</section>

    <section class="slide">
      <img src="pics/grant-permission.png" alt="scheme of an attack" />
    </section>

    <section class="slide">
      <img height="90%" src="pics/execution.png" alt="scheme of an attack" />
    </section>

    <section class="slide">
      Malware being written to file.
      <details>
        Solution:
        <ol>
          <li>apply things like Mark-of-th-Web to files</li>
          <li>
            the API does not provide ability to make files executable unless
            opened files are already exucutable
          </li>
          <li>run malware checks (ffects performance)</li>
        </ol>
      </details>
    </section>

    <section class="slide">
      Ransomware attacks
      <details>
        Solution:
        <ol>
          <li>Does not allow access to sensitive directories and files</li>
        </ol>
      </details>
    </section>

    <section class="slide">
      Fillin up a user's disk
      <details style="max-height: 100%; overflow: auto">
        Filling up a users disk Other than files in the origin private file
        system, files written by this API are not subject to storage quota. As
        such websites can fill up a users disk without being limited by quota,
        which could leave a users device in a bad state (do note that even with
        storage that is subject to storage quota it is still possible to fill
        up, or come close to filling up, a users disk, since storage quota in
        general is not dependent on the amount of available disk space). Without
        this API websites can write data to disk not subject to quota
        limitations already by triggering downloads of large files (potentially
        created client side, to not incur any network overhead). While the
        presence of truncate() and writing at a potentially really large offset
        past the end of a file makes it much easier and lower cost to create
        large files, on most file systems such files should not actually take up
        as much disk space as most commonly used file systems support sparse
        files (and thus wouldn‚Äôt actually store the NUL bytes generated by
        resizing a file or seeking past the end of it). Whatever mitigations
        user agents use to guard against websites filling up a disk via either
        quota managed storage or the existing downloads mechanism should also be
        employed when websites use this API to write to disk.
      </details>
    </section>

    <section class="slide">
      <img src="pics/file-names.png" alt="file names issue description" />
    </section>

    <section class="slide">
      <img src="pics/file-mapping.png" alt="file mapping issue description" />
    </section>

    <section class="slide">
      <img
        src="pics/only-read-and-readwrite-modes-issue.png"
        alt="readwrite mode issues"
      />
    </section>

    <section class="slide">
      <img
        src="pics/in-place-file-modification.png"
        alt="inplace file modification mode issue"
      />
      <details>
        No changes made to fileEntry won't be reflected in real file until
        writable stream is closed.
      </details>
    </section>

    <footer class="badge">
      <a href="https://github.com/shower/shower">Fork me on GitHub</a>
    </footer>

    <div class="progress"></div>

    <script src="shower/shower.js"></script>
    <!-- Copyright ¬© 2021 Yours Truly, Famous Inc. -->
  </body>
</html>
